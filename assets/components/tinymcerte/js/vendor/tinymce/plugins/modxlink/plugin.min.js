/*!
 * TinyMCE Rich Text Editor - TinyMCE 5
 * Version: 2.0.4
 * Build date: 2021-12-03
 */

!function(){"use strict";function i(t){return function(){return t}}var n,t=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=tinymce.util.Tools.resolve("tinymce.util.VK"),e=function(e){return function(t){return t=typeof(n=t),(null===n?"null":"object"==t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t)===e;var n}},r=function(n){return function(t){return typeof t===n}},u=e("string"),o=e("array"),l=function(t){return n===t},c=r("boolean"),f=r("function"),s=function(){},e=function(t){return t},m=function(t,n){return t===n},g=i(!1),d=i(!(n=null)),r=function(){return h},h={fold:function(t,n){return t()},isSome:g,isNone:d,getOr:e,getOrThunk:p,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:e,orThunk:p,map:r,each:s,bind:r,exists:g,forall:d,filter:function(){return h},toArray:function(){return[]},toString:i("none()")};function p(t){return t()}function v(e){function t(){return o}function n(t){return t(e)}var r=i(e),o={fold:function(t,n){return n(e)},isSome:d,isNone:g,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:t,orThunk:t,map:function(t){return v(t(e))},each:function(t){t(e)},bind:n,exists:n,forall:n,filter:function(t){return t(e)?o:h},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o}function y(t,e,r){return function(t,n){for(var e=0,r=t.length;e<r;e++)n(t[e],e)}(t,function(t,n){r=e(r,t,n)}),r}function k(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return J.none()}function x(t,n,e){return void 0===e&&(e=m),t.exists(function(t){return e(t,n)})}function b(t,n){return t?J.some(n):J.none()}function O(t){return t=t.getParam("link_assume_external_targets",!1),c(t)&&t?1:!u(t)||"http"!==t&&"https"!==t?0:t}function w(t){return t.getParam("default_link_target")}function C(t){return t.getParam("target_list",!0)}function A(t){return t.getParam("rel_list",[],"array")}function N(t){return t.getParam("allow_unsafe_link_target",!1,"boolean")}function P(n){return void 0===n&&(n=rt),function(t){return J.from(t).map(function(t){return ot(t,n)})}}function T(t,e,r,o){return function(t,n){for(var e=at(t),r=0,o=e.length;r<o;r++){var i=e[r];n(t[i],i)}}(t,function(t,n){(e(t,n)?r:o)(t,n)}),1}function S(t,n){return lt.call(t,n)}function R(t){return t&&"a"===t.nodeName.toLowerCase()}function D(t){return R(t)&&!!st(t)}function E(t,n){if(t.collapsed)return[];for(var t=t.cloneContents(),e=new ct(t.firstChild,t),r=[],o=t.firstChild;n(o)&&r.push(o),o=e.next(););return r}function L(t,n){function e(t){return t.filter(function(t){return-1===et.inArray(r,t)})}var r=["noopener"],t=t?t.split(/\s+/):[],t=n?0<(n=e(n=t)).length?n.concat(r):r:e(t);return 0<t.length?et.trim(t.sort().join(" ")):""}function M(t){return t&&"FIGURE"===t.nodeName&&/\bimage\b/i.test(t.className)}function U(t,n){var e,n=ut({},n);return 0<A(t).length||!1!==N(t)||(e=L(n.rel,"_blank"===n.target),n.rel=e||null),J.from(n.target).isNone()&&!1===C(t)&&(n.target=w(t)),n.href=(e=n.href,"http"!==(t=O(t))&&"https"!==t||ft(e)?e:t+"://"+e),n}function B(n,t,e,r){M(t)?function(t,n,e){var r=t.dom.select("img",n)[0];if(r){var o=t.dom.create("a",e);r.parentNode.insertBefore(o,r);o.appendChild(r)}}(n,t,r):e.fold(function(){n.execCommand("mceInsertLink",!1,r)},function(t){n.insertContent(n.dom.createHTML("a",r,n.dom.encode(t)))})}function I(o,i,u){var t,a=o.selection.getNode(),l=mt(o,a),c=U(o,y(["title","rel","class","target"],function(n,e){return t[e].each(function(t){n[e]=0<t.length?t:null}),n},{href:(t=u).href}));o.undoManager.transact(function(){var t,n,e,r;u.href===i.href&&i.attach(),l?(o.focus(),t=o,n=l,e=u.text,r=c,e.each(function(t){S(n,"innerText")?n.innerText=t:n.textContent=t}),t.dom.setAttribs(n,r),t.selection.select(n)):B(o,a,u.text,c)})}function K(u){u.undoManager.transact(function(){var t,n,e,r,o,i=u.selection.getNode();M(i)?function(t,n){var e=t.dom.select("img",n)[0];if(e){var r=t.dom.getParents(e,"a[href]",n)[0];if(r){r.parentNode.insertBefore(e,r);t.dom.remove(r)}}}(u,i):(n=(t=u).dom,e=t.selection,r=e.getBookmark(),o=e.getRng().cloneRange(),i=n.getParent(o.startContainer,"a[href]",t.getBody()),n=n.getParent(o.endContainer,"a[href]",t.getBody()),i&&o.setStartBefore(i),n&&o.setEndAfter(n),e.setRng(o),t.execCommand("unlink"),e.moveToBookmark(r)),u.focus()})}function z(t){var e,n=t.class,r=t.href,o=t.rel,i=t.target,u=t.text,t=t.title;return t={class:n.getOrNull(),href:r,rel:o.getOrNull(),target:i.getOrNull(),text:u.getOrNull(),title:t.getOrNull()},T(t,function(t,n){return!1===l(t)},(e=t={},function(t,n){e[n]=t}),s),t}function j(t){return S(n=t,t="items")&&void 0!==n[t]&&null!==n[t];var n}function V(n,t,e,r){var t=r[t],o=0<n.length;return void 0!==t?yt(t,e).map(function(t){return{url:{value:t.value,meta:{text:o?n:t.text,attach:s}},text:o?n:t.display||t.text}}):J.none()}function q(t){var n=t.href;return 0<n.indexOf("@")&&-1===n.indexOf("/")&&-1===n.indexOf("mailto:")?J.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(t){return ut(ut({},t),{href:"mailto:"+n})}}):J.none()}function F(f){var t,n;(n=mt(t=f),Rt(t,n)).then(function(t){var o,i,n,e,r,u,a,l,c;return e=function(t){var e=t.getData();if(!e.url.value)return vt(o),void t.close();var n=function(n){return J.from(e[n]).filter(function(t){return!x(i.anchor[n],t)})},n={href:e.url.value,text:n("text"),target:n("target"),rel:n("rel"),class:n("linkClass"),title:n("title")},r={href:e.url.value,attach:void 0!==e.url.meta&&e.url.meta.attach?e.url.meta.attach:s};Ot(o,n).then(function(t){pt(o,r,t)}),t.close()},r=o=f,u=(n=i=t).anchor.text.map(function(){return{name:"text",type:"input",label:"Text to display"}}).toArray(),a=n.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],l=J.from(w(r)),t=l,l={url:{value:r=(l=(r=n).anchor).url.getOr(""),meta:{original:{value:r}}},text:l.text.getOr(""),title:l.title.getOr(""),anchor:r,link:r,rel:l.rel.getOr(""),target:l.target.or(t).getOr(""),linkClass:l.linkClass.getOr("")},n=n.catalogs,c=kt(l,n),{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:Z([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],n.link.map(it.createUi("link",_("tinymcerte.select_resource"))).toArray(),u,a,function(t){for(var n=[],e=function(t){n.push(t)},r=0;r<t.length;r++)t[r].each(e);return n}([n.anchor.map(it.createUi("anchor","Anchors")),n.rels.map(it.createUi("rel","Rel")),n.targets.map(it.createUi("target","Open link in...")),n.classes.map(it.createUi("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:l,onChange:function(n,t){t=t.name;c.onChange(n.getData,{name:t}).each(function(t){n.setData(t)})},onSubmit:e}}).then(function(t){f.windowManager.open(t)})}function W(t){var n;(n=document.createElement("a")).target="_blank",n.href=t,n.rel="noreferrer noopener",(t=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n=n,t=t,document.body.appendChild(n),n.dispatchEvent(t),document.body.removeChild(n)}function H(t,n){return t.on("NodeChange",n),function(){return t.off("NodeChange",n)}}function G(r){function t(t){var n=r.selection.getNode();return t.setDisabled(!mt(r,n)),s}r.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:It(r)},label:"Link",predicate:function(t){return!!mt(r,t)&&tt(r)},initValue:function(){var t=mt(r);return t?st(t):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(t){var n=r.selection.getNode();return t.setActive(!!mt(r,n)),It(r)(t)},onAction:function(t){var n=t.getValue(),e=function(t){var n=mt(r),e=ht(r);if(n||!e)return J.none();n=gt(r.selection,n);return J.some(0<n.length?n:t)}(n);pt(r,{href:n,attach:s},{href:n,text:e,title:J.none(),rel:J.none(),target:J.none(),class:J.none()}),r.selection.collapse(!1),t.hide()}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:t,onAction:function(t){vt(r),t.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:t,onAction:function(t){Bt(r)(),t.hide()}}]})}var J={some:v,none:r,from:function(t){return null==t?h:v(t)}},X=Array.prototype.indexOf,$=Array.prototype.push,Q=function(t,n){return X.call(t,n)},Y=function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o)}return r},Z=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!o(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);$.apply(n,t[e])}return n},tt=function(t){return t.getParam("link_context_toolbar",!1,"boolean")},nt=function(t){return t.getParam("link_quicklink",!1,"boolean")},et=tinymce.util.Tools.resolve("tinymce.util.Tools"),rt=function(t){return u(t.value)?t.value:""},ot=function(t,r){var o=[];return et.each(t,function(t){var n,e,n=u((n=t).text)?n.text:u(n.title)?n.title:"";void 0!==t.menu?(e=ot(t.menu,r),o.push({text:n,items:e})):(e=r(t),o.push({text:n,value:e,display:t.display||"",classes:t.classes||""}))}),o},it={sanitize:function(t){return P(rt)(t)},sanitizeWith:P,createUi:function(n,e){return function(t){return{name:n,type:"listbox",label:e,items:t}}},getValue:rt},ut=function(){return(ut=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},at=Object.keys,lt=Object.hasOwnProperty,ct=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),ft=function(t){return/^\w+:/i.test(t)},st=function(t){var n=t.getAttribute("data-mce-href");return n||t.getAttribute("href")},mt=function(t,n){return n=n||t.selection.getNode(),M(n)?t.dom.select("a[href]",n)[0]:t.dom.getParent(n,"a[href]")},gt=function(t,n){return(n?n.innerText||n.textContent:t.getContent({format:"text"})).replace(/\uFEFF/g,"")},dt=function(t){return 0<et.grep(t,D).length},ht=function(t){var n=t.schema.getTextInlineElements();return 0===E(t.selection.getRng(),function(t){return 1===t.nodeType&&!R(t)&&!S(n,t.nodeName.toLowerCase())}).length},pt=function(t,n,e){t.hasPlugin("rtc",!0)?t.execCommand("createlink",!1,z(e)):I(t,n,e)},vt=function(t){t.hasPlugin("rtc",!0)?t.execCommand("unlink"):K(t)},yt=function(n,t){return k(t,function(t){return j(t)?yt(n,t.items):b(t.value===n,t)})},kt=function(t,o){function i(t,n){var e,r=(r=o,("link"===(e=n.name)?r.link:"anchor"===e?r.anchor:J.none()).getOr([]));return V(u.text,n.name,r,t)}var u={text:t.text,title:t.title},a=function(t){return b(u.title.length<=0,J.from(t.meta.title).getOr(""))},l=function(t){return b(u.text.length<=0,J.from(t.meta.text).getOr(t.value))};return{onChange:function(t,n){var e,r,o=n.name;return"url"===o?(e=t(),r=l(e.url),e=a(e.url),r.isSome()||e.isSome()?J.some(ut(ut({},r.map(function(t){return{text:t}}).getOr({})),e.map(function(t){return{title:t}}).getOr({}))):J.none()):-1<Q(["anchor","link"],o)?i(t(),n):(("text"===o||"title"===o)&&(u[o]=t()[o]),J.none())}}},xt=tinymce.util.Tools.resolve("tinymce.util.Delay"),bt=tinymce.util.Tools.resolve("tinymce.util.Promise"),Ot=function(u,a){return k([q,(e=O(u),r=u.getParam("link_default_protocol","http","string"),function(t){var n=t.href;return 1===e&&!ft(n)||0===e&&/^\s*www(\.|\d\.)/i.test(n)?J.some({message:"The URL you entered seems to be an external link. Do you want to add the required "+r+":// prefix?",preprocess:function(t){return ut(ut({},t),{href:r+"://"+n})}}):J.none()})],function(t){return t(a)}).fold(function(){return bt.resolve(a)},function(i){return new bt(function(n){var e,t,r,o;e=u,t=i.message,r=function(t){n(t?i.preprocess(a):a)},o=e.selection.getRng(),xt.setEditorTimeout(e,function(){e.windowManager.confirm(t,function(t){e.selection.setRng(o),r(t)})})})});var e,r},wt=function(t){t=t.dom.select("a:not([href])"),t=Z(Y(t,function(t){t=t.name||t.id;return t?[{text:t,value:"#"+t}]:[]}));return 0<t.length?J.some([{text:"None",value:""}].concat(t)):J.none()},Ct=function(t){t=t.getParam("link_class_list",[],"array");return 0<t.length?it.sanitize(t):J.none()},At=tinymce.util.Tools.resolve("tinymce.util.XHR"),Nt=function(n){function e(t){return n.convertURL(t.value||t.url,"href")}var t=n.getParam("link_list");return new bt(function(n){u(t)?At.send({url:t,success:function(t){return n(function(t){try{return J.some(JSON.parse(t))}catch(t){return J.none()}}(t))},error:function(t){return n(J.none())}}):f(t)?t(function(t){return n(J.some(t))}):n(J.from(t))}).then(function(t){return t.bind(it.sanitizeWith(e)).map(function(t){return 0<t.length?[{text:_("tinymcerte.select_none"),value:""}].concat(t):t})})},Pt=function(t,n){var e=A(t);if(0<e.length){var r=x(n,"_blank");return(!1===N(t)?it.sanitizeWith(function(t){return L(it.getValue(t),r)}):it.sanitize)(e)}return J.none()},Tt=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],_t=function(t){t=C(t);return o(t)?it.sanitize(t).orThunk(function(){return J.some(Tt)}):!1===t?J.none():J.some(Tt)},St=function(t,n,e){e=t.getAttrib(n,e);return null!==e&&0<e.length?J.some(e):J.none()},Rt=function(l,c){return Nt(l).then(function(t){var n,e,r,o,i,u,a,n=(e=c,r=(n=l).dom,o=ht(n)?J.some(gt(n.selection,e)):J.none(),i=e?J.some(r.getAttrib(e,"href")):J.none(),u=e?J.from(r.getAttrib(e,"target")):J.none(),a=St(r,e,"rel"),n=St(r,e,"class"),{url:i,text:o,title:St(r,e,"title"),target:u,rel:a,linkClass:n});return{anchor:n,catalogs:{targets:_t(l),rels:Pt(l,n.target),classes:Ct(l),anchor:wt(l),link:t},optNode:J.from(c),flags:{titleEnabled:l.getParam("link_title",!0,"boolean")}}})},Dt=function(t,n){return t.dom.getParent(n,"a[href]")},Et=function(t){return Dt(t,t.selection.getStart())},Lt=function(t){return!0===t.altKey&&!1===t.shiftKey&&!1===t.ctrlKey&&!1===t.metaKey},Mt=function(t,n){var e;n&&(e=st(n),/^#/.test(e)?(e=t.$(e)).length&&t.selection.scrollIntoView(e[0],!0):W(n.href))},Ut=function(t){return function(){F(t)}},Bt=function(t){return function(){Mt(t,Et(t))}},It=function(e){return function(t){function n(){return t.setActive(!e.mode.isReadOnly()&&null!==mt(e,e.selection.getNode()))}return n(),H(e,n)}},Kt=function(e){return function(t){function n(){return t.setDisabled(null===mt(e,e.selection.getNode()))}return n(),H(e,n)}},zt=function(r){return function(n){function e(t){return dt(t)||(t=r.selection.getRng(),0<E(t,D).length)}var t=r.dom.getParents(r.selection.getStart());return n.setDisabled(!e(t)),H(r,function(t){return n.setDisabled(!e(t.parents))})}};t.add("modxlink",function(t){var n,e,r,o,i,u;(n=t).ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:Ut(n),onSetup:It(n)}),n.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:Bt(n),onSetup:Kt(n)}),n.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return vt(n)},onSetup:zt(n)}),(e=t).ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:Bt(e),onSetup:Kt(e)}),e.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:Ut(e)}),e.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return vt(e)},onSetup:zt(e)}),(r=t).ui.registry.addContextMenu("link",{update:function(t){return dt(r.dom.getParents(t,"a"))?"link unlink openlink":"link"}}),G(t),(o=t).on("click",function(t){var n=Dt(o,t.target);n&&a.metaKeyPressed(t)&&(t.preventDefault(),Mt(o,n))}),o.on("keydown",function(t){var n=Et(o);n&&13===t.keyCode&&Lt(t)&&(t.preventDefault(),Mt(o,n))}),(i=t).addCommand("mceLink",function(){nt(i)?i.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):Ut(i)()}),(u=t).addShortcut("Meta+K","",function(){u.execCommand("mceLink")})})}();